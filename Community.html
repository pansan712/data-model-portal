<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Data Model Competency - Community</title>
    <style>
        :root {
            --primary: #1e3a5f; --primary-light: #2d5a87; --primary-lighter: #3d7ab5;
            --accent: #0078d4; --success: #28a745; --warning: #ffc107;
            --bg: #f5f7fa; --bg-card: #ffffff; --text: #323130;
            --text-light: #605e5c; --text-lighter: #a19f9d; --border: #edebe9;
            --shadow: 0 2px 8px rgba(0,0,0,0.08); --shadow-hover: 0 4px 16px rgba(0,0,0,0.12);
            --radius: 10px; --radius-lg: 16px; --transition: all 0.25s ease;
            --font: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: var(--font); background: var(--bg); color: var(--text); line-height: 1.6; }
        .portal-nav { background: var(--primary); padding: 0 40px; display: flex; align-items: center; height: 50px; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 8px rgba(0,0,0,0.15); }
        .portal-nav .logo { color: white; font-weight: 700; font-size: 1.1em; margin-right: 40px; text-decoration: none; white-space: nowrap; }
        .portal-nav .nav-links { display: flex; gap: 0; list-style: none; height: 100%; }
        .portal-nav .nav-links li { height: 100%; }
        .portal-nav .nav-links a { color: rgba(255,255,255,0.85); text-decoration: none; padding: 0 18px; font-size: 0.9em; font-weight: 500; display: flex; align-items: center; height: 100%; transition: var(--transition); border-bottom: 3px solid transparent; }
        .portal-nav .nav-links a:hover, .portal-nav .nav-links a.active { color: white; background: rgba(255,255,255,0.1); border-bottom-color: white; }
        .container { max-width: 1280px; margin: 0 auto; padding: 0 30px; }
        .page-hero { background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%); color: white; padding: 50px 40px; position: relative; overflow: hidden; }
        .page-hero::before { content: ''; position: absolute; top: -50%; right: -20%; width: 60%; height: 200%; background: radial-gradient(ellipse, rgba(255,255,255,0.06) 0%, transparent 70%); }
        .page-hero h1 { font-size: 2.5em; margin-bottom: 10px; position: relative; }
        .page-hero p { font-size: 1.2em; opacity: 0.9; position: relative; }
        .section { padding: 40px 0; }
        .section-title { font-size: 1.5em; color: var(--primary); border-bottom: 3px solid var(--primary-light); padding-bottom: 10px; margin-bottom: 25px; display: flex; align-items: center; gap: 10px; }

        /* Two Column */
        .two-col { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; }

        /* Feature Card */
        .feature-card {
            padding: 30px;
            border-radius: var(--radius-lg);
            border-left: 5px solid var(--primary-light);
        }
        .feature-card.blue { background: linear-gradient(135deg, #e8f4fd 0%, #d4e9f7 100%); border-left-color: var(--primary-light); }
        .feature-card.green { background: linear-gradient(135deg, #f0f9f0 0%, #e0f2e0 100%); border-left-color: var(--success); }
        .feature-card h2 { color: var(--primary); margin-bottom: 12px; font-size: 1.3em; }
        .feature-card p { color: #444; margin-bottom: 12px; font-size: 0.95em; }
        .feature-card .label { color: var(--text-light); font-size: 0.9em; font-weight: 600; margin-bottom: 5px; }
        .feature-card ul { padding-left: 18px; color: var(--text-light); font-size: 0.9em; margin-bottom: 15px; }
        .feature-card ul li { padding: 3px 0; }
        .feature-card .note { font-size: 0.85em; color: #888; font-style: italic; }

        .btn { padding: 12px 28px; border-radius: 25px; text-decoration: none; font-weight: 600; font-size: 0.95em; display: inline-flex; align-items: center; gap: 8px; transition: var(--transition); cursor: pointer; border: none; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-primary:hover { background: var(--primary-light); transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }

        /* Review Request Table */
        .review-table { width: 100%; border-collapse: collapse; background: var(--bg-card); border-radius: var(--radius); overflow: hidden; box-shadow: var(--shadow); }
        .review-table thead { background: var(--primary); color: white; }
        .review-table th { padding: 14px 16px; text-align: left; font-weight: 600; font-size: 0.9em; }
        .review-table td { padding: 12px 16px; border-bottom: 1px solid var(--border); font-size: 0.88em; }
        .review-table tr:hover td { background: #f8f9fa; }
        .status-badge { padding: 3px 10px; border-radius: 12px; font-size: 0.75em; font-weight: 600; display: inline-block; }
        .status-submitted { background: #fef7e0; color: #e37400; }
        .status-assigned { background: #e8f0fe; color: #1967d2; }
        .status-in-review { background: #fce8e6; color: #c5221f; }
        .status-feedback { background: #e6f4ea; color: #1e7e34; }
        .status-closed { background: #f0f0f0; color: #666; }

        /* Form */
        .review-form { background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius-lg); padding: 30px; margin-top: 30px; }
        .review-form h3 { color: var(--primary); margin-bottom: 20px; }
        .form-row { margin-bottom: 18px; }
        .form-row label { display: block; font-weight: 600; font-size: 0.9em; color: var(--text); margin-bottom: 6px; }
        .form-row input, .form-row select, .form-row textarea {
            width: 100%; padding: 10px 14px; border: 1px solid var(--border); border-radius: 8px;
            font-family: var(--font); font-size: 0.9em; color: var(--text);
            transition: border-color 0.2s;
        }
        .form-row input:focus, .form-row select:focus, .form-row textarea:focus { outline: none; border-color: var(--primary-light); box-shadow: 0 0 0 3px rgba(45,90,135,0.1); }
        .form-row textarea { min-height: 100px; resize: vertical; }
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 18px; }
        .form-message { padding: 12px 16px; border-radius: 8px; margin-top: 15px; display: none; font-size: 0.9em; }
        .form-message.success { background: #e6f4ea; color: #1e7e34; display: block; }
        .form-message.error { background: #fce8e6; color: #c5221f; display: block; }

        .loading { text-align: center; padding: 40px; color: var(--text-lighter); }
        .spinner { display: inline-block; width: 24px; height: 24px; border: 3px solid var(--border); border-top-color: var(--primary); border-radius: 50%; animation: spin 0.8s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .portal-footer { background: var(--primary); color: rgba(255,255,255,0.7); padding: 20px 40px; text-align: center; font-size: 0.85em; margin-top: 40px; }

        @media (max-width: 800px) {
            .two-col { grid-template-columns: 1fr; }
            .form-grid { grid-template-columns: 1fr; }
        }
        @media (max-width: 768px) {
            .page-hero { padding: 30px 20px; } .page-hero h1 { font-size: 1.8em; }
            .container { padding: 0 15px; }
            .portal-nav { padding: 0 15px; } .portal-nav .nav-links a { padding: 0 10px; font-size: 0.82em; }
        }
    </style>
</head>
<body>

    <nav class="portal-nav">
        <a href="Home.html" class="logo">Data Model Competency</a>
        <ul class="nav-links">
            <li><a href="Home.html">Home</a></li>
            <li><a href="Showcase.html">Showcase</a></li>
            <li><a href="Accelerators.html">Accelerators</a></li>
            <li><a href="Knowledge.html">Knowledge</a></li>
            <li><a href="Community.html" class="active">Community</a></li>
            <li><a href="Metrics.html">Metrics</a></li>
        </ul>
    </nav>

    <section class="page-hero">
        <h1>&#x1F465; Community</h1>
        <p>Connect with experts, request reviews, and participate in knowledge sharing</p>
    </section>

    <div class="container">

        <!-- Review & Office Hours -->
        <section class="section">
            <div class="two-col">
                <div class="feature-card blue">
                    <h2>&#x1F4DD; Request a Review</h2>
                    <p>Need expert feedback on your data model? Submit a review request and get guidance from our specialists.</p>
                    <p class="label">What we review:</p>
                    <ul>
                        <li>Dimensional models (Star Schema)</li>
                        <li>Data Vault designs</li>
                        <li>ERD diagrams &amp; logical models</li>
                        <li>DDL scripts &amp; naming conventions</li>
                        <li>dbt project structure</li>
                        <li>Performance optimization</li>
                    </ul>
                    <a href="#reviewForm" class="btn btn-primary">Submit Request &rarr;</a>
                </div>
                <div class="feature-card green">
                    <h2>&#x1F5D3;&#xFE0F; Office Hours</h2>
                    <p>Join our weekly data modeling office hours for Q&amp;A, pattern discussions, and expert guidance.</p>
                    <p class="label">Schedule:</p>
                    <ul>
                        <li><strong>Tuesdays</strong> 2:00 PM - 3:00 PM IST</li>
                        <li><strong>Thursdays</strong> 10:00 AM - 11:00 AM IST</li>
                    </ul>
                    <p class="label" style="margin-top:12px;">Upcoming Topics:</p>
                    <ul>
                        <li>Feb 18 &ndash; Data Vault 2.0 Deep Dive</li>
                        <li>Feb 20 &ndash; BigQuery Optimization Patterns</li>
                        <li>Feb 25 &ndash; Activity Schema Workshop</li>
                    </ul>
                    <p class="note" style="margin-top:15px;">Teams link shared via calendar invite</p>
                </div>
            </div>
        </section>

        <!-- Active Reviews -->
        <section class="section">
            <h2 class="section-title">&#x1F4CB; Active Review Requests</h2>
            <div id="reviewsTable">
                <div class="loading"><div class="spinner"></div><p>Loading reviews...</p></div>
            </div>
        </section>

        <!-- Review Request Form -->
        <section class="section" id="reviewForm">
            <div class="review-form">
                <h3>&#x1F4DD; Submit a Model Review Request</h3>
                <form id="reviewRequestForm" onsubmit="submitReview(event)">
                    <div class="form-row">
                        <label>Review Title *</label>
                        <input type="text" id="reqTitle" placeholder="e.g., Customer 360 Star Schema Review" required />
                    </div>
                    <div class="form-grid">
                        <div class="form-row">
                            <label>Model Type *</label>
                            <select id="reqModelType" required>
                                <option value="">Select model type...</option>
                                <option value="Dimensional">Dimensional (Star Schema)</option>
                                <option value="Data Vault">Data Vault</option>
                                <option value="Activity Schema">Activity Schema</option>
                                <option value="Graph">Graph Model</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="form-row">
                            <label>Platform *</label>
                            <select id="reqPlatform" required>
                                <option value="">Select platform...</option>
                                <option value="BigQuery">BigQuery</option>
                                <option value="Snowflake">Snowflake</option>
                                <option value="Databricks">Databricks</option>
                                <option value="Synapse">Azure Synapse</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-grid">
                        <div class="form-row">
                            <label>Complexity</label>
                            <select id="reqComplexity">
                                <option value="Simple (1-5 tables)">Simple (1-5 tables)</option>
                                <option value="Medium (6-15 tables)">Medium (6-15 tables)</option>
                                <option value="Complex (16+ tables)">Complex (16+ tables)</option>
                            </select>
                        </div>
                        <div class="form-row">
                            <label>Desired Deadline</label>
                            <input type="date" id="reqDeadline" />
                        </div>
                    </div>
                    <div class="form-row">
                        <label>Link to Artifacts (ERD, DDL, etc.)</label>
                        <input type="url" id="reqArtifacts" placeholder="https://..." />
                    </div>
                    <div class="form-row">
                        <label>Specific Questions or Focus Areas</label>
                        <textarea id="reqQuestions" placeholder="What specific aspects would you like reviewed? Any concerns or areas of uncertainty?"></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary" id="submitBtn">&#x1F4E8; Submit Review Request</button>
                    <div id="formMessage" class="form-message"></div>
                </form>
            </div>
        </section>

    </div>

    <footer class="portal-footer">
        Data Model Competency &ndash; Center of Excellence &bull; Data &amp; Insights Team &bull; Ascendion &bull; &copy; 2026
    </footer>

    <script type="text/javascript">
        var SITE_URL = (typeof _spPageContextInfo !== 'undefined' && _spPageContextInfo) ? _spPageContextInfo.webAbsoluteUrl : '';
        if (!SITE_URL) {
            var loc = window.location.href;
            var siteMatch = loc.match(/(https:\/\/[^/]+\/sites\/[^/]+\/[^/]+)/i);
            if (siteMatch) SITE_URL = siteMatch[1];
            else SITE_URL = 'https://ascendionhub.sharepoint.com/sites/DataNInsights2.0/DataModelCompetency';
        }

        function spGet(listName) {
            return fetch(SITE_URL + '/_api/web/lists/getbytitle(\'' + listName + '\')/items?$top=100&$orderby=Created desc', {
                headers: { 'Accept': 'application/json;odata=verbose' },
                credentials: 'include'
            }).then(function(r) { return r.json(); })
              .then(function(d) { return d.d ? d.d.results : []; })
              .catch(function() { return []; });
        }

        function getDigest() {
            return fetch(SITE_URL + '/_api/contextinfo', {
                method: 'POST',
                headers: { 'Accept': 'application/json;odata=verbose' },
                credentials: 'include'
            }).then(function(r) { return r.json(); })
              .then(function(d) { return d.d.GetContextWebInformation.FormDigestValue; })
              .catch(function() { return ''; });
        }

        function getStatusClass(status) {
            var map = {
                'Submitted': 'status-submitted',
                'Assigned': 'status-assigned',
                'In Review': 'status-in-review',
                'Feedback Provided': 'status-feedback',
                'Closed': 'status-closed'
            };
            return map[status] || 'status-submitted';
        }

        function loadReviews() {
            spGet('ReviewRequests').then(function(results) {
                var container = document.getElementById('reviewsTable');
                if (!results.length) {
                    results = [
                        { Title: 'Healthcare Patient Analytics Model', ModelType: 'Dimensional', Platform: 'BigQuery', Complexity: 'Complex (16+ tables)', Status: 'In Review', Created: '2026-02-10' },
                        { Title: 'Retail Customer Segmentation Schema', ModelType: 'Data Vault', Platform: 'Snowflake', Complexity: 'Medium (6-15 tables)', Status: 'Submitted', Created: '2026-02-08' },
                        { Title: 'Supply Chain Graph Model', ModelType: 'Graph', Platform: 'Databricks', Complexity: 'Complex (16+ tables)', Status: 'Feedback Provided', Created: '2026-02-05' }
                    ];
                }
                var html = '<table class="review-table"><thead><tr><th>Title</th><th>Model Type</th><th>Platform</th><th>Complexity</th><th>Status</th></tr></thead><tbody>';
                results.forEach(function(r) {
                    html += '<tr>' +
                        '<td><strong>' + (r.Title || '') + '</strong></td>' +
                        '<td>' + (r.ModelType || '') + '</td>' +
                        '<td>' + (r.Platform || '') + '</td>' +
                        '<td>' + (r.Complexity || '') + '</td>' +
                        '<td><span class="status-badge ' + getStatusClass(r.Status) + '">' + (r.Status || '') + '</span></td></tr>';
                });
                html += '</tbody></table>';
                container.innerHTML = html;
            });
        }

        function submitReview(e) {
            e.preventDefault();
            var btn = document.getElementById('submitBtn');
            var msg = document.getElementById('formMessage');
            btn.disabled = true;
            btn.textContent = 'Submitting...';

            var data = {
                '__metadata': { 'type': 'SP.Data.ReviewRequestsListItem' },
                'Title': document.getElementById('reqTitle').value,
                'ModelType': document.getElementById('reqModelType').value,
                'Platform': document.getElementById('reqPlatform').value,
                'Complexity': document.getElementById('reqComplexity').value,
                'SpecificQuestions': document.getElementById('reqQuestions').value,
                'Status': 'Submitted'
            };

            getDigest().then(function(digest) {
                if (!digest) {
                    msg.className = 'form-message error';
                    msg.textContent = 'Unable to connect to SharePoint. Please submit your request directly via the ReviewRequests list.';
                    msg.style.display = 'block';
                    btn.disabled = false;
                    btn.innerHTML = '&#x1F4E8; Submit Review Request';
                    return;
                }

                return fetch(SITE_URL + '/_api/web/lists/getbytitle(\'ReviewRequests\')/items', {
                    method: 'POST',
                    headers: {
                        'Accept': 'application/json;odata=verbose',
                        'Content-Type': 'application/json;odata=verbose',
                        'X-RequestDigest': digest
                    },
                    credentials: 'include',
                    body: JSON.stringify(data)
                });
            }).then(function(response) {
                if (response && response.ok) {
                    msg.className = 'form-message success';
                    msg.textContent = 'Review request submitted successfully! Our team will review and assign a reviewer shortly.';
                    msg.style.display = 'block';
                    document.getElementById('reviewRequestForm').reset();
                    loadReviews();
                } else if (response) {
                    throw new Error('Failed to submit');
                }
            }).catch(function(err) {
                msg.className = 'form-message error';
                msg.textContent = 'Error submitting request. Please try submitting directly via the ReviewRequests list or contact the team.';
                msg.style.display = 'block';
            }).finally(function() {
                btn.disabled = false;
                btn.innerHTML = '&#x1F4E8; Submit Review Request';
            });
        }

        try { loadReviews(); } catch(e) { console.log('API load skipped:', e); }
    </script>

</body>
</html>
