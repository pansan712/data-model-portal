<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Data Model Competency - Metrics Dashboard</title>
    <style>
        :root {
            --primary: #1e3a5f; --primary-light: #2d5a87; --primary-lighter: #3d7ab5;
            --accent: #0078d4; --success: #28a745; --warning: #ffc107;
            --bg: #f5f7fa; --bg-card: #ffffff; --text: #323130;
            --text-light: #605e5c; --text-lighter: #a19f9d; --border: #edebe9;
            --shadow: 0 2px 8px rgba(0,0,0,0.08); --shadow-hover: 0 4px 16px rgba(0,0,0,0.12);
            --radius: 10px; --radius-lg: 16px; --transition: all 0.25s ease;
            --font: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: var(--font); background: var(--bg); color: var(--text); line-height: 1.6; }
        .portal-nav { background: var(--primary); padding: 0 40px; display: flex; align-items: center; height: 50px; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 8px rgba(0,0,0,0.15); }
        .portal-nav .logo { color: white; font-weight: 700; font-size: 1.1em; margin-right: 40px; text-decoration: none; white-space: nowrap; }
        .portal-nav .nav-links { display: flex; gap: 0; list-style: none; height: 100%; }
        .portal-nav .nav-links li { height: 100%; }
        .portal-nav .nav-links a { color: rgba(255,255,255,0.85); text-decoration: none; padding: 0 18px; font-size: 0.9em; font-weight: 500; display: flex; align-items: center; height: 100%; transition: var(--transition); border-bottom: 3px solid transparent; }
        .portal-nav .nav-links a:hover, .portal-nav .nav-links a.active { color: white; background: rgba(255,255,255,0.1); border-bottom-color: white; }
        .container { max-width: 1280px; margin: 0 auto; padding: 0 30px; }
        .page-hero { background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%); color: white; padding: 50px 40px; position: relative; overflow: hidden; }
        .page-hero::before { content: ''; position: absolute; top: -50%; right: -20%; width: 60%; height: 200%; background: radial-gradient(ellipse, rgba(255,255,255,0.06) 0%, transparent 70%); }
        .page-hero h1 { font-size: 2.5em; margin-bottom: 10px; position: relative; }
        .page-hero p { font-size: 1.2em; opacity: 0.9; position: relative; }
        .section { padding: 40px 0; }
        .section-title { font-size: 1.5em; color: var(--primary); border-bottom: 3px solid var(--primary-light); padding-bottom: 10px; margin-bottom: 25px; display: flex; align-items: center; gap: 10px; }

        /* KPI Cards */
        .kpi-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; }
        .kpi-card {
            background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius-lg);
            padding: 25px; text-align: center; position: relative; overflow: hidden;
            transition: var(--transition);
        }
        .kpi-card:hover { box-shadow: var(--shadow-hover); transform: translateY(-3px); }
        .kpi-card .kpi-icon { font-size: 1.8em; margin-bottom: 10px; }
        .kpi-card .kpi-value { font-size: 2.5em; font-weight: 700; color: var(--primary); line-height: 1.1; }
        .kpi-card .kpi-label { font-size: 0.88em; color: var(--text-light); margin-top: 6px; }
        .kpi-card .kpi-trend { font-size: 0.8em; margin-top: 8px; padding: 3px 10px; border-radius: 12px; display: inline-block; }
        .kpi-trend.up { background: #e6f4ea; color: #1e7e34; }
        .kpi-trend.down { background: #fce8e6; color: #c5221f; }
        .kpi-trend.neutral { background: #f0f0f0; color: #666; }

        /* Chart Placeholder */
        .chart-container {
            background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius-lg);
            padding: 30px; margin-bottom: 20px;
        }
        .chart-title { font-size: 1.1em; color: var(--primary); margin-bottom: 20px; font-weight: 600; }

        /* Simple Bar Chart (CSS only) */
        .bar-chart { display: flex; align-items: flex-end; gap: 12px; height: 200px; padding: 0 10px; }
        .bar-col { display: flex; flex-direction: column; align-items: center; flex: 1; }
        .bar { width: 100%; border-radius: 6px 6px 0 0; min-height: 4px; transition: height 0.6s ease; position: relative; }
        .bar:hover { opacity: 0.85; }
        .bar .bar-value { position: absolute; top: -22px; left: 50%; transform: translateX(-50%); font-size: 0.78em; font-weight: 600; color: var(--text); }
        .bar-label { font-size: 0.78em; color: var(--text-light); margin-top: 8px; text-align: center; }

        /* Donut Chart (CSS) */
        .donut-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 25px; }
        .donut-card { background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius-lg); padding: 25px; text-align: center; }
        .donut-card h4 { color: var(--primary); margin-bottom: 15px; }
        .donut-ring { width: 120px; height: 120px; border-radius: 50%; position: relative; margin: 0 auto 15px; }
        .donut-ring .donut-value { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 1.5em; font-weight: 700; color: var(--primary); }
        .donut-legend { text-align: left; display: inline-block; }
        .donut-legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.85em; color: var(--text-light); padding: 3px 0; }
        .legend-dot { width: 10px; height: 10px; border-radius: 50%; flex-shrink: 0; }

        /* Data Table */
        .data-table { width: 100%; border-collapse: collapse; background: var(--bg-card); border-radius: var(--radius); overflow: hidden; box-shadow: var(--shadow); }
        .data-table thead { background: var(--primary); color: white; }
        .data-table th { padding: 14px 16px; text-align: left; font-weight: 600; font-size: 0.9em; }
        .data-table td { padding: 12px 16px; border-bottom: 1px solid var(--border); font-size: 0.88em; }
        .data-table tr:hover td { background: #f8f9fa; }

        /* Power BI Placeholder */
        .pbi-placeholder {
            padding: 60px; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: var(--radius-lg); text-align: center; border: 2px dashed #dee2e6;
        }
        .pbi-placeholder .icon { font-size: 4em; margin-bottom: 15px; }
        .pbi-placeholder h2 { color: var(--primary); margin-bottom: 10px; }
        .pbi-placeholder p { color: var(--text-light); font-size: 0.95em; }
        .pbi-list { list-style: none; padding: 0; margin-top: 15px; }
        .pbi-list li { padding: 4px 0; color: var(--text-light); font-size: 0.9em; }

        .loading { text-align: center; padding: 40px; color: var(--text-lighter); }
        .spinner { display: inline-block; width: 24px; height: 24px; border: 3px solid var(--border); border-top-color: var(--primary); border-radius: 50%; animation: spin 0.8s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .portal-footer { background: var(--primary); color: rgba(255,255,255,0.7); padding: 20px 40px; text-align: center; font-size: 0.85em; margin-top: 40px; }

        @media (max-width: 900px) { .kpi-grid { grid-template-columns: repeat(2, 1fr); } }
        @media (max-width: 768px) {
            .page-hero { padding: 30px 20px; } .page-hero h1 { font-size: 1.8em; }
            .container { padding: 0 15px; } .kpi-grid { grid-template-columns: 1fr 1fr; }
            .portal-nav { padding: 0 15px; } .portal-nav .nav-links a { padding: 0 10px; font-size: 0.82em; }
        }
    </style>
</head>
<body>

    <nav class="portal-nav">
        <a href="Home.html" class="logo">Data Model Competency</a>
        <ul class="nav-links">
            <li><a href="Home.html">Home</a></li>
            <li><a href="Showcase.html">Showcase</a></li>
            <li><a href="Accelerators.html">Accelerators</a></li>
            <li><a href="Knowledge.html">Knowledge</a></li>
            <li><a href="Community.html">Community</a></li>
            <li><a href="Metrics.html" class="active">Metrics</a></li>
        </ul>
    </nav>

    <section class="page-hero">
        <h1>&#x1F4CA; Metrics Dashboard</h1>
        <p>Track delivery metrics, tool usage, and quality scores</p>
    </section>

    <div class="container">

        <!-- KPI Cards -->
        <section class="section">
            <div class="kpi-grid" id="kpiGrid">
                <div class="kpi-card">
                    <div class="kpi-icon">&#x1F4E6;</div>
                    <div class="kpi-value" id="kpiModels">--</div>
                    <div class="kpi-label">Models Delivered</div>
                    <span class="kpi-trend up" id="kpiModelsTrend">Loading...</span>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">&#x1F4D0;</div>
                    <div class="kpi-value" id="kpiPatterns">--</div>
                    <div class="kpi-label">Patterns Available</div>
                    <span class="kpi-trend neutral">Library</span>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">&#x1F50D;</div>
                    <div class="kpi-value" id="kpiReviews">--</div>
                    <div class="kpi-label">Reviews Completed</div>
                    <span class="kpi-trend up" id="kpiReviewsTrend">Loading...</span>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">&#x1F465;</div>
                    <div class="kpi-value" id="kpiTeam">--</div>
                    <div class="kpi-label">Team Members</div>
                    <span class="kpi-trend neutral">Active</span>
                </div>
            </div>
        </section>

        <!-- Charts Row -->
        <section class="section">
            <div style="display:grid; grid-template-columns: 1.2fr 0.8fr; gap:25px;">

                <!-- Models by Platform -->
                <div class="chart-container">
                    <div class="chart-title">Models Delivered by Platform</div>
                    <div class="bar-chart" id="platformChart">
                        <div class="bar-col">
                            <div class="bar" style="height:85%; background: linear-gradient(180deg, #4285f4, #669df6);">
                                <span class="bar-value">12</span>
                            </div>
                            <span class="bar-label">BigQuery</span>
                        </div>
                        <div class="bar-col">
                            <div class="bar" style="height:65%; background: linear-gradient(180deg, #29b5e8, #56c8f0);">
                                <span class="bar-value">8</span>
                            </div>
                            <span class="bar-label">Snowflake</span>
                        </div>
                        <div class="bar-col">
                            <div class="bar" style="height:45%; background: linear-gradient(180deg, #ff3621, #ff6b55);">
                                <span class="bar-value">5</span>
                            </div>
                            <span class="bar-label">Databricks</span>
                        </div>
                        <div class="bar-col">
                            <div class="bar" style="height:30%; background: linear-gradient(180deg, #0078d4, #4da3e2);">
                                <span class="bar-value">3</span>
                            </div>
                            <span class="bar-label">Synapse</span>
                        </div>
                        <div class="bar-col">
                            <div class="bar" style="height:20%; background: linear-gradient(180deg, #8c4fff, #a87aff);">
                                <span class="bar-value">2</span>
                            </div>
                            <span class="bar-label">Redshift</span>
                        </div>
                    </div>
                </div>

                <!-- Model Types Donut -->
                <div class="chart-container">
                    <div class="chart-title">Models by Pattern Type</div>
                    <div style="text-align:center;">
                        <div class="donut-ring" style="background: conic-gradient(#1e3a5f 0% 45%, #2d5a87 45% 70%, #3d7ab5 70% 85%, #6ba3d6 85% 95%, #a8cce8 95% 100%);">
                            <span class="donut-value">30</span>
                        </div>
                        <div class="donut-legend">
                            <div class="donut-legend-item"><span class="legend-dot" style="background:#1e3a5f;"></span>Star Schema (45%)</div>
                            <div class="donut-legend-item"><span class="legend-dot" style="background:#2d5a87;"></span>Data Vault (25%)</div>
                            <div class="donut-legend-item"><span class="legend-dot" style="background:#3d7ab5;"></span>Activity Schema (15%)</div>
                            <div class="donut-legend-item"><span class="legend-dot" style="background:#6ba3d6;"></span>Graph (10%)</div>
                            <div class="donut-legend-item"><span class="legend-dot" style="background:#a8cce8;"></span>Other (5%)</div>
                        </div>
                    </div>
                </div>

            </div>
        </section>

        <!-- Monthly Trend -->
        <section class="section">
            <div class="chart-container">
                <div class="chart-title">Monthly Delivery Trend (2025-2026)</div>
                <div class="bar-chart" id="monthlyChart" style="height:180px;">
                    <div class="bar-col"><div class="bar" style="height:30%; background: linear-gradient(180deg, var(--primary-light), var(--primary-lighter));"><span class="bar-value">2</span></div><span class="bar-label">Sep</span></div>
                    <div class="bar-col"><div class="bar" style="height:45%; background: linear-gradient(180deg, var(--primary-light), var(--primary-lighter));"><span class="bar-value">3</span></div><span class="bar-label">Oct</span></div>
                    <div class="bar-col"><div class="bar" style="height:60%; background: linear-gradient(180deg, var(--primary-light), var(--primary-lighter));"><span class="bar-value">4</span></div><span class="bar-label">Nov</span></div>
                    <div class="bar-col"><div class="bar" style="height:45%; background: linear-gradient(180deg, var(--primary-light), var(--primary-lighter));"><span class="bar-value">3</span></div><span class="bar-label">Dec</span></div>
                    <div class="bar-col"><div class="bar" style="height:75%; background: linear-gradient(180deg, var(--primary-light), var(--primary-lighter));"><span class="bar-value">5</span></div><span class="bar-label">Jan</span></div>
                    <div class="bar-col"><div class="bar" style="height:60%; background: linear-gradient(180deg, var(--primary-light), var(--primary-lighter));"><span class="bar-value">4</span></div><span class="bar-label">Feb</span></div>
                </div>
            </div>
        </section>

        <!-- Estimated Time Saved -->
        <section class="section">
            <div class="donut-row">
                <div class="donut-card">
                    <h4>Estimated Time Saved</h4>
                    <div class="donut-ring" style="background: conic-gradient(var(--success) 0% 68%, #e0e0e0 68% 100%);">
                        <span class="donut-value" style="font-size:1.2em;">~120h</span>
                    </div>
                    <p style="color:var(--text-light); font-size:0.88em;">Across all accelerator usage</p>
                </div>
                <div class="donut-card">
                    <h4>Pattern Reuse Rate</h4>
                    <div class="donut-ring" style="background: conic-gradient(var(--primary-light) 0% 73%, #e0e0e0 73% 100%);">
                        <span class="donut-value" style="font-size:1.2em;">73%</span>
                    </div>
                    <p style="color:var(--text-light); font-size:0.88em;">Projects using existing patterns</p>
                </div>
                <div class="donut-card">
                    <h4>Average Quality Score</h4>
                    <div class="donut-ring" style="background: conic-gradient(#4285f4 0% 87%, #e0e0e0 87% 100%);">
                        <span class="donut-value" style="font-size:1.2em;">87%</span>
                    </div>
                    <p style="color:var(--text-light); font-size:0.88em;">Across production models</p>
                </div>
                <div class="donut-card">
                    <h4>Review SLA Met</h4>
                    <div class="donut-ring" style="background: conic-gradient(var(--warning) 0% 91%, #e0e0e0 91% 100%);">
                        <span class="donut-value" style="font-size:1.2em;">91%</span>
                    </div>
                    <p style="color:var(--text-light); font-size:0.88em;">Reviews completed within SLA</p>
                </div>
            </div>
        </section>

        <!-- Power BI Placeholder -->
        <section class="section">
            <h2 class="section-title">&#x1F4CA; Interactive Dashboard</h2>
            <div class="pbi-placeholder">
                <div class="icon">&#x1F4CA;</div>
                <h2>Power BI Dashboard</h2>
                <p>Coming Soon &ndash; Phase 2</p>
                <ul class="pbi-list">
                    <li>Interactive dashboards will be embedded here showing:</li>
                    <li>&#x2022; Models Delivered (YTD/QTD/MTD) with drill-down</li>
                    <li>&#x2022; Accelerator Usage Trends</li>
                    <li>&#x2022; Quality Score Distribution &amp; Trends</li>
                    <li>&#x2022; Pattern Reuse Rate by Project</li>
                    <li>&#x2022; Team Utilization &amp; Workload</li>
                </ul>
            </div>
        </section>

        <!-- Recent Usage -->
        <section class="section">
            <h2 class="section-title">&#x1F4C8; Recent Usage Activity</h2>
            <div id="usageTable">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Feature</th>
                            <th>Platform</th>
                            <th>Pattern</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="usageBody">
                    </tbody>
                </table>
            </div>
        </section>

    </div>

    <footer class="portal-footer">
        Data Model Competency &ndash; Center of Excellence &bull; Data &amp; Insights Team &bull; Ascendion &bull; &copy; 2026
    </footer>

    <script type="text/javascript">
        var SITE_URL = (typeof _spPageContextInfo !== 'undefined' && _spPageContextInfo) ? _spPageContextInfo.webAbsoluteUrl : '';
        if (!SITE_URL) {
            var loc = window.location.href;
            var siteMatch = loc.match(/(https:\/\/[^/]+\/sites\/[^/]+\/[^/]+)/i);
            if (siteMatch) SITE_URL = siteMatch[1];
            else SITE_URL = 'https://ascendionhub.sharepoint.com/sites/DataNInsights2.0/DataModelCompetency';
        }

        function spGet(listName) {
            return fetch(SITE_URL + '/_api/web/lists/getbytitle(\'' + listName + '\')/items?$top=500', {
                headers: { 'Accept': 'application/json;odata=verbose' },
                credentials: 'include'
            }).then(function(r) { return r.json(); })
              .then(function(d) { return d.d ? d.d.results : []; })
              .catch(function() { return []; });
        }

        function loadKPIs() {
            var lists = [
                { id: 'kpiModels', list: 'Projects', trendId: 'kpiModelsTrend' },
                { id: 'kpiPatterns', list: 'Patterns' },
                { id: 'kpiReviews', list: 'ReviewRequests', trendId: 'kpiReviewsTrend' },
                { id: 'kpiTeam', list: 'TeamMembers' }
            ];
            lists.forEach(function(item) {
                spGet(item.list).then(function(results) {
                    var count = results.length;
                    var el = document.getElementById(item.id);
                    if (el) el.textContent = count || '0';
                    if (item.trendId) {
                        var trendEl = document.getElementById(item.trendId);
                        if (trendEl && count > 0) {
                            trendEl.textContent = '+' + Math.ceil(count * 0.15) + ' this month';
                            trendEl.className = 'kpi-trend up';
                        }
                    }
                });
            });
        }

        function loadUsage() {
            spGet('UsageMetrics').then(function(results) {
                var tbody = document.getElementById('usageBody');
                if (!results.length) {
                    results = [
                        { MetricDate: '2026-02-11', Feature: 'PatternDownload', Platform: 'BigQuery', Pattern: 'Star Schema', Success: true },
                        { MetricDate: '2026-02-10', Feature: 'ReviewRequest', Platform: 'Snowflake', Pattern: 'Data Vault', Success: true },
                        { MetricDate: '2026-02-09', Feature: 'PatternDownload', Platform: 'Databricks', Pattern: 'Activity Schema', Success: true },
                        { MetricDate: '2026-02-08', Feature: 'DocumentationGen', Platform: 'BigQuery', Pattern: 'SCD Type 2', Success: true },
                        { MetricDate: '2026-02-07', Feature: 'NamingValidator', Platform: 'Snowflake', Pattern: '-', Success: false },
                        { MetricDate: '2026-02-06', Feature: 'PatternDownload', Platform: 'BigQuery', Pattern: 'Bridge Table', Success: true },
                        { MetricDate: '2026-02-05', Feature: 'ModelGenerator', Platform: 'Databricks', Pattern: 'Star Schema', Success: true }
                    ];
                }
                var html = '';
                results.slice(0, 10).forEach(function(u) {
                    var date = u.MetricDate ? u.MetricDate.substring(0, 10) : '';
                    var success = u.Success !== false;
                    html += '<tr>' +
                        '<td>' + date + '</td>' +
                        '<td>' + (u.Feature || '') + '</td>' +
                        '<td>' + (u.Platform || '') + '</td>' +
                        '<td>' + (u.Pattern || '') + '</td>' +
                        '<td><span style="color:' + (success ? 'var(--success)' : 'var(--warning)') + '; font-weight:600;">' + (success ? 'Success' : 'Warning') + '</span></td></tr>';
                });
                tbody.innerHTML = html;
            });
        }

        try { loadKPIs(); loadUsage(); } catch(e) { console.log('API load skipped:', e); }
    </script>

</body>
</html>
